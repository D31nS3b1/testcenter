<mat-card class="main-alert" attr.data-cy="main-alert:{{error.type}}" *ngIf="error">
  <mat-card-title>
    <alert text="{{ error.label }}" [level]="error.type =='warning' ? 'warning' : 'error'"></alert>
    <button
      *ngIf="!uncloseable"
      mat-icon-button
      class="main-alert-close-button"
      (click)="closeClick()"
      [matTooltip]="closeCaption ?? defaultCloseCaption ?? 'Schließen'"
    >
      <mat-icon>close</mat-icon>
    </button>
  </mat-card-title>
  <mat-card-content>
    <ng-content></ng-content>
    <div *ngIf="error.type === 'network_temporally'">
      <h3 *ngIf="restartTimer$ | async as second">
        Die Anwendung wird wird in {{ waitUnitAutomaticRestartSeconds - second }} Sekunden neu geladen.
      </h3>
    </div>
    <div id="errorDetailsWrapper" *ngIf="errorDetailsOpen">
      <b>Fehlerbericht</b>
      <div id="errorDetails">
        <p><b>{{error.label}}</b></p>
        <p>{{error.description}}</p>
        <p>{{error.details}}</p>
        <p *ngIf="error.errorId"><b>Error-Id:</b> {{error.errorId}}</p>
        <p *ngFor="let item of additionalReport | keyvalue">
          <b>{{item.key}}:</b>{{item.value}}
        </p>
        <p><b>Browser: </b>{{browser.browser.name}} {{browser.browser.version}}</p>
        <p><b>Betriebssystem: </b>{{browser.os.name}} {{browser.os.version}}</p>
        <p><b>Gerät: </b>{{browser.device.type}} {{browser.device.vendor}} {{browser.device.model}}</p>
        <br *ngIf="errorBuffer.length">
        <p *ngIf="errorBuffer.length"><b>Weitere Fehler:</b></p>
        <div *ngFor="let err of errorBuffer">
          <p><b>{{err.label}}: </b>{{err.description}}</p>
          <p>{{err.details}}</p>
          <p *ngIf="err.errorId"><b>Error-Id:</b> {{err.errorId}}</p>
        </div>
      </div>
    </div>
  </mat-card-content>
  <mat-card-actions>
    <button
      *ngIf="!uncloseable"
      mat-raised-button
      color="primary"
      (click)="closeClick()"
    >
      {{closeCaption ?? defaultCloseCaption ?? 'Schließen'}}
    </button>
    <button mat-raised-button (click)="toggleErrorDetails()">Fehlerdetails</button>
  </mat-card-actions>
</mat-card>