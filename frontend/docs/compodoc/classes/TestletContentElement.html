<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>itc-ng documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css" media="(prefers-color-scheme: dark)">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">itc-ng documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content class">
                   <div class="content-data">











<ol class="breadcrumb">
  <li>Classes</li>
  <li >TestletContentElement</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/test-controller/classes/test-controller.classes.ts</code>
        </p>






            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#children" >children</a>
                            </li>
                            <li>
                                    <span class="modifier">Readonly</span>
                                <a href="#id" >id</a>
                            </li>
                            <li>
                                    <span class="modifier">Readonly</span>
                                <a href="#sequenceId" >sequenceId</a>
                            </li>
                            <li>
                                    <span class="modifier">Readonly</span>
                                <a href="#title" >title</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#getMaxSequenceId" >getMaxSequenceId</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>

            <section>
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(sequenceId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>, id: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, title: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="9" class="link-to-prism">src/app/test-controller/classes/test-controller.classes.ts:9</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>sequenceId</td>
                                                  
                                                        <td>
                                                                        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>id</td>
                                                  
                                                        <td>
                                                                        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>title</td>
                                                  
                                                        <td>
                                                                        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section>
    
    <h3 id="inputs">
        Properties
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="children"></a>
                    <span class="name">
                        <span ><b>children</b></span>
                        <a href="#children"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="../interfaces/Testlet.html" target="_self" >TestletContentElement[]</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="9" class="link-to-prism">src/app/test-controller/classes/test-controller.classes.ts:9</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="id"></a>
                    <span class="name">
                            <span class="modifier">Readonly</span>
                        <span ><b>id</b></span>
                        <a href="#id"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="7" class="link-to-prism">src/app/test-controller/classes/test-controller.classes.ts:7</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="sequenceId"></a>
                    <span class="name">
                            <span class="modifier">Readonly</span>
                        <span ><b>sequenceId</b></span>
                        <a href="#sequenceId"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="6" class="link-to-prism">src/app/test-controller/classes/test-controller.classes.ts:6</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="title"></a>
                    <span class="name">
                            <span class="modifier">Readonly</span>
                        <span ><b>title</b></span>
                        <a href="#title"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="8" class="link-to-prism">src/app/test-controller/classes/test-controller.classes.ts:8</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
</section>

            <section>
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getMaxSequenceId"></a>
                    <span class="name">
                        <span ><b>getMaxSequenceId</b></span>
                        <a href="#getMaxSequenceId"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>getMaxSequenceId(tmpId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank">number</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="18"
                            class="link-to-prism">src/app/test-controller/classes/test-controller.classes.ts:18</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Default value</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>tmpId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>

                                    <td>
                                        <code>0</code>
                                    </td>

                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>





    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { MaxTimerDataType, NavigationLeaveRestrictionValue } from &#x27;../interfaces/test-controller.interfaces&#x27;;

export class TestletContentElement {
  readonly sequenceId: number;
  readonly id: string;
  readonly title: string;
  children: TestletContentElement[];

  constructor(sequenceId: number, id: string, title: string) {
    this.sequenceId &#x3D; sequenceId;
    this.id &#x3D; id;
    this.title &#x3D; title;
    this.children &#x3D; [];
  }

  getMaxSequenceId(tmpId &#x3D; 0): number {
    let maxSequenceId &#x3D; tmpId;
    if (this.sequenceId &gt;&#x3D; maxSequenceId) {
      maxSequenceId &#x3D; this.sequenceId + 1;
    }
    this.children.forEach(tce &#x3D;&gt; {
      maxSequenceId &#x3D; tce.getMaxSequenceId(maxSequenceId);
    });
    return maxSequenceId;
  }
}

export class UnitDef extends TestletContentElement {
  readonly alias: string;
  readonly naviButtonLabel: string;
  playerId: string;
  locked &#x3D; false;
  readonly navigationLeaveRestrictions: NavigationLeaveRestrictions;

  constructor(
    sequenceId: number,
    id: string,
    title: string,
    alias: string,
    naviButtonLabel: string,
    navigationLeaveRestrictions: NavigationLeaveRestrictions
  ) {
    super(sequenceId, id, title);
    this.alias &#x3D; alias;
    this.naviButtonLabel &#x3D; naviButtonLabel;
    this.navigationLeaveRestrictions &#x3D; navigationLeaveRestrictions;
  }
}

export class UnitControllerData {
  unitDef: UnitDef &#x3D; null;
  codeRequiringTestlets: Testlet[] &#x3D; [];
  maxTimerRequiringTestlet: Testlet &#x3D; null;
  testletLabel &#x3D; &#x27;&#x27;;
  constructor(unitDef: UnitDef) {
    this.unitDef &#x3D; unitDef;
  }
}

export class NavigationLeaveRestrictions {
  readonly presentationComplete: NavigationLeaveRestrictionValue &#x3D; &#x27;OFF&#x27;;
  readonly responseComplete: NavigationLeaveRestrictionValue &#x3D; &#x27;OFF&#x27;;

  constructor(presentationComplete: NavigationLeaveRestrictionValue,
              responseComplete: NavigationLeaveRestrictionValue) {
    this.presentationComplete &#x3D; presentationComplete;
    this.responseComplete &#x3D; responseComplete;
  }
}

export class Testlet extends TestletContentElement {
  codeToEnter &#x3D; &#x27;&#x27;;
  codePrompt &#x3D; &#x27;&#x27;;
  maxTimeLeft &#x3D; -1;

  addTestlet(id: string, title: string): Testlet {
    const newChild &#x3D; new Testlet(0, id, title);
    this.children.push(newChild);
    return newChild;
  }

  addUnit(
    sequenceId: number,
    id: string,
    title: string,
    alias: string,
    naviButtonLabel: string,
    navigationLeaveRestrictions: NavigationLeaveRestrictions
  ): UnitDef {
    const newChild &#x3D; new UnitDef(sequenceId, id, title, alias, naviButtonLabel, navigationLeaveRestrictions);
    this.children.push(newChild);
    return newChild;
  }

  // first looking for the unit, then on the way back adding restrictions
  getUnitAt(sequenceId: number, isEntryPoint &#x3D; true): UnitControllerData {
    let myreturn: UnitControllerData &#x3D; null;
    for (let i &#x3D; 0; i &lt; this.children.length; i++) {
      const tce &#x3D; this.children[i];
      if (tce instanceof Testlet) {
        const localTestlet &#x3D; tce as Testlet;
        myreturn &#x3D; localTestlet.getUnitAt(sequenceId, false);
        if (myreturn !&#x3D;&#x3D; null) {
          break;
        }
      } else if (tce instanceof UnitDef) {
        if (tce.sequenceId &#x3D;&#x3D;&#x3D; sequenceId) {
          myreturn &#x3D; new UnitControllerData(tce);
          break;
        }
      }
    }
    if (myreturn !&#x3D;&#x3D; null) {
      if (this.codeToEnter.length &gt; 0) {
        myreturn.codeRequiringTestlets.push(this);
      }
      if (this.maxTimeLeft &gt; 0) {
        myreturn.maxTimerRequiringTestlet &#x3D; this;
      }
      if (!isEntryPoint) {
        const label &#x3D; this.title.trim();
        if (label) {
          myreturn.testletLabel &#x3D; label;
        }
      }
    }
    return myreturn;
  }

  getSequenceIdByUnitAlias(alias: string): number {
    let myReturn &#x3D; 0;
    for (let i &#x3D; 0; i &lt; this.children.length; i++) {
      const tce &#x3D; this.children[i];
      if (tce instanceof Testlet) {
        const localTestlet &#x3D; tce as Testlet;
        myReturn &#x3D; localTestlet.getSequenceIdByUnitAlias(alias);
        if (myReturn &gt;&#x3D; 0) {
          break;
        }
      } else if (tce instanceof UnitDef) {
        if (tce.alias &#x3D;&#x3D;&#x3D; alias) {
          myReturn &#x3D; (tce as UnitDef).sequenceId;
          break;
        }
      }
    }
    return myReturn;
  }

  getTestlet(testletId: string): Testlet {
    let myreturn &#x3D; null;
    if (this.id &#x3D;&#x3D;&#x3D; testletId) {
      myreturn &#x3D; this;
    } else {
      for (let i &#x3D; 0; i &lt; this.children.length; i++) {
        const tce &#x3D; this.children[i];
        if (tce instanceof Testlet) {
          const localTestlet &#x3D; tce as Testlet;
          myreturn &#x3D; localTestlet.getTestlet(testletId);
          if (myreturn !&#x3D;&#x3D; null) {
            break;
          }
        }
      }
    }
    return myreturn;
  }

  getAllUnitSequenceIds(testletId &#x3D; &#x27;&#x27;): number[] {
    let myreturn &#x3D; [];

    if (testletId) {
      // find testlet
      const myTestlet &#x3D; this.getTestlet(testletId);
      if (myTestlet) {
        myreturn &#x3D; myTestlet.getAllUnitSequenceIds();
      }
    } else {
      for (let i &#x3D; 0; i &lt; this.children.length; i++) {
        const tce &#x3D; this.children[i];
        if (tce instanceof Testlet) {
          const localTestlet &#x3D; tce as Testlet;
          localTestlet.getAllUnitSequenceIds().forEach(u &#x3D;&gt; myreturn.push(u));
        } else {
          const localUnit &#x3D; tce as UnitDef;
          myreturn.push(localUnit.sequenceId);
        }
      }
    }
    return myreturn;
  }

  setTimeLeft(testletId: string, maxTimeLeft: number): void {
    if (testletId) {
      // find testlet
      const testlet &#x3D; this.getTestlet(testletId);
      if (testlet) {
        testlet.setTimeLeft(&#x27;&#x27;, maxTimeLeft);
        if (maxTimeLeft &#x3D;&#x3D;&#x3D; 0) {
          testlet.lockAllChildren();
        }
      }
    } else {
      this.maxTimeLeft &#x3D; maxTimeLeft;
      for (let i &#x3D; 0; i &lt; this.children.length; i++) {
        const tce &#x3D; this.children[i];
        if (tce instanceof Testlet) {
          tce.setTimeLeft(&#x27;&#x27;, maxTimeLeft);
        }
      }
    }
  }

  lockAllChildren(testletId &#x3D; &#x27;&#x27;): void {
    if (testletId) {
      const testlet &#x3D; this.getTestlet(testletId);
      if (testlet) {
        testlet.lockAllChildren();
      }
    } else {
      for (let i &#x3D; 0; i &lt; this.children.length; i++) {
        const tce &#x3D; this.children[i];
        if (tce instanceof Testlet) {
          const localTestlet &#x3D; tce as Testlet;
          localTestlet.lockAllChildren();
        } else {
          const localUnit &#x3D; tce as UnitDef;
          localUnit.locked &#x3D; true;
        }
      }
    }
  }

  lockUnitsIfTimeLeftNull(lock &#x3D; false): void {
    // eslint-disable-next-line no-param-reassign
    lock &#x3D; lock || this.maxTimeLeft &#x3D;&#x3D;&#x3D; 0;
    for (let i &#x3D; 0; i &lt; this.children.length; i++) {
      const tce &#x3D; this.children[i];
      if (tce instanceof Testlet) {
        const localTestlet &#x3D; tce as Testlet;
        localTestlet.lockUnitsIfTimeLeftNull(lock);
      } else if (lock) {
        const localUnit &#x3D; tce as UnitDef;
        localUnit.locked &#x3D; true;
      }
    }
  }

  getNextUnlockedUnitSequenceId(currentUnitSequenceId: number): number {
    let nextUnitSequenceId &#x3D; currentUnitSequenceId + 1;
    let myUnit: UnitControllerData &#x3D; this.getUnitAt(nextUnitSequenceId);
    while (myUnit !&#x3D;&#x3D; null &amp;&amp; myUnit.unitDef.locked) {
      nextUnitSequenceId +&#x3D; 1;
      myUnit &#x3D; this.getUnitAt(nextUnitSequenceId);
    }
    return myUnit ? nextUnitSequenceId : currentUnitSequenceId;
  }
}

export class EnvironmentData {
  appVersion: string;
  browserVersion &#x3D; &#x27;&#x27;;
  browserName &#x3D; &#x27;&#x27;;
  get browserTxt(): string {
    return &#x60;${this.browserName} Version ${this.browserVersion}&#x60;;
  }

  osName &#x3D; &#x27;&#x27;;
  device &#x3D; &#x27;&#x27; ;

  screenSizeWidth &#x3D; 0;
  screenSizeHeight &#x3D; 0;
  loadTime: number &#x3D; 0;
  get screenSizeTxt(): string {
    return &#x60;Bildschirmgröße ist ${this.screenSizeWidth} x ${this.screenSizeWidth}&#x60;;
  }

  constructor(appVersion: string) {
    this.appVersion &#x3D; appVersion;

    // eslint-disable-next-line @typescript-eslint/dot-notation
    const UAParser &#x3D; window[&#x27;UAParser&#x27;]();

    this.browserVersion &#x3D; UAParser.browser.version;
    this.browserName &#x3D; UAParser.browser.name;
    this.osName &#x3D; &#x60;${UAParser.os.name} ${UAParser.os.version}&#x60;;
    this.device &#x3D; Object.values(UAParser.device)
      .filter(elem &#x3D;&gt; elem)
      .join(&#x27; &#x27;);

    this.screenSizeHeight &#x3D; window.screen.height;
    this.screenSizeWidth &#x3D; window.screen.width;
  }
}

export class MaxTimerData {
  timeLeftSeconds: number; // seconds
  testletId: string;
  type: MaxTimerDataType;

  get timeLeftString(): string {
    const afterDecimal &#x3D; Math.round(this.timeLeftSeconds % 60);
    const a &#x3D; (Math.round(this.timeLeftSeconds - afterDecimal) / 60).toString();
    const b &#x3D; afterDecimal &lt; 10 ? &#x27;0&#x27; : &#x27;&#x27;;
    const c &#x3D; afterDecimal.toString();
    return &#x60;${a}:${b}${c}&#x60;;
  }

  get timeLeftMinString(): string {
    return &#x60;${Math.round(this.timeLeftSeconds / 60).toString()} min&#x60;;
  }

  constructor(timeMinutes: number, tId: string, type: MaxTimerDataType) {
    this.timeLeftSeconds &#x3D; timeMinutes * 60;
    this.testletId &#x3D; tId;
    this.type &#x3D; type;
  }
}
</code></pre>
    </div>
</div>








                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'class';
            var COMPODOC_CURRENT_PAGE_URL = 'TestletContentElement.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
