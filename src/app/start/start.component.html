<div class="page-body">
  <div fxLayout="row" fxLayoutAlign="center stretch" fxLayoutGap="30px" style="padding: 30px;">


    <!-- XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX -->
    <mat-card fxFlex="350px" fxLayout="column" *ngIf="showLoginForm">
      <!-- - - - - - - - - - - - - - - - - -->
      <mat-card-title>Anmelden</mat-card-title>
      <mat-card-content>
        <form [formGroup]="testtakerloginform" (ngSubmit)="testtakerlogin()" fxLayout="column">
          <mat-form-field class="full-width">
            <input matInput formControlName="testname" placeholder="Anmeldename" (keyup.enter)="pw.focus()">
          </mat-form-field>
          <mat-form-field class="full-width">
            <input matInput #pw type="password" formControlName="testpw" placeholder="Kennwort" (keyup.enter)="testtakerlogin()">
          </mat-form-field>
        </form>
      </mat-card-content>
      <mat-card-actions>
        <button mat-raised-button type="submit" [disabled]="testtakerloginform.invalid" color="primary">Weiter</button>
      </mat-card-actions>
    </mat-card>

    <!-- - - - - - - - - - - - - - - - - -->
    <mat-card fxFlex="350px" fxLayout="column" *ngIf="showCodeForm">
      <mat-card-title>Anmelden</mat-card-title>
      <mat-card-content>
        <form [formGroup]="codeinputform" (ngSubmit)="codeinput()" *ngIf="" fxLayout="column">
          <mat-form-field class="full-width">
            <input matInput formControlName="code" placeholder="Personen-Code"(keyup.enter)="codeinput()">
          </mat-form-field>
        </form>
      </mat-card-content>
      <mat-card-actions>
        <button mat-raised-button type="submit" [disabled]="codeinputform.invalid" color="primary">Weiter</button>
      </mat-card-actions>
    </mat-card>

    <!-- - - - - - - - - - - - - - - - - -->
    <mat-card fxFlex="350px" fxLayout="column" *ngIf="showBookletButtons">
      <mat-card-title>Bitte wählen</mat-card-title>
      <mat-card-content>
        <div fxLayout="row" fxLayoutGap="10px" fxLayout="column">
          <p *ngIf="bookletlist.length === 0">
            Für diese Anmeldung wurde kein Test gefunden.
          </p>
          <button mat-raised-button class="bookletselectbutton" (click)="buttonStartTest(b)"
            [disabled]="!b.isEnabled" *ngFor="let b of bookletlist">
              <p class="booklet_title">{{b.label}}</p>
              <p class="booklet_status">{{b.statustxt}}</p>
          </button>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- - - - - - - - - - - - - - - - - -->
    <mat-card fxFlex="350px" fxLayout="column" *ngIf="showTestRunningButtons">
      <mat-card-title>Bitte Testheft wählen</mat-card-title>
      <mat-card-content>
        <div fxLayout="column" fxLayoutGap="20px">
          <button mat-raised-button color="primary" [routerLink]="['/t']">Zum Test zurückkehren</button>
          <button mat-raised-button color="primary" (click)="buttonEndTest()">{{ testEndButtonText }}</button>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX -->
    <!-- XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX -->
    <mat-card fxFlex="30%" fxLayout="column" class="status">
      <mat-card-title>IQB-Testcenter</mat-card-title>

      <!-- - - - - - - - - - - - - - - - - -->
      <mat-card-content>
        <div *ngIf="showLoginForm">
          <p>Das <a href="http://www.iqb.hu-berlin.de" target="_blank">Institut zur Qualitätsentwicklung im Bildungswesen</a>
            betreibt auf diesen Seiten eine Pilotanwendung für das computerbasierte Leistungstesten von
            Schülerinnen und Schülern. Der Zugang zu einem Test ist nur möglich, wenn Sie von Testverantwortlichen
            Zugangsdaten erhalten haben, die Sie bitte links eingeben. Es sind keine weiteren Seiten öffentlich verfügbar.</p>

          <p>Die mit diesem Testsystem erhobenen Daten sind vertraulich und enthalten grundsätzlich keinen direkten
            Personenbezug. Es werden z. B. nie Namen gespeichert. Um Auskünfte zu einer bestimmten Studie
            zu erhalten, wenden Sie sich bitte an das <a href="mailto:mechtel@iqb.hu-berlin.de?subject=Zum%20IQB-Testsystem">
              IQB</a>. Wir benötigen dazu den ungefähren Testzeitraum und das Bundesland, in dem die Studie
              durchgeführt wurde.</p>
        </div>

        <!-- - - - - - - - - - - - - - - - - -->
        <div *ngIf="!showLoginForm">
          <p>Anmeldestatus:</p>
          <ul>
            <li *ngFor="let line of loginStatusText">{{ line }}</li>
          </ul>
        </div>

        <!-- - - - - - - - - - - - - - - - - -->
        <div *ngIf="showCodeForm">
          <p>Für das Starten eines Tests ist die Eingabe eines Personen-Codes nötig.</p>
          <p>{{ codeInputPromt }}</p>
        </div>

        <!-- - - - - - - - - - - - - - - - - -->
        <div *ngIf="showBookletButtons">
          <p *ngIf="bookletlist.length === 0">Fehler: Kein Testmaterial für diese Anmeldung gefunden.</p>
          <p *ngIf="bookletlist.length === 1">{{ bookletSelectPromptOne }}</p>
          <p *ngIf="bookletlist.length > 1">{{ bookletSelectPromptMany }}</p>
        </div>

        <!-- - - - - - - - - - - - - - - - - -->
        <div *ngIf="showTestRunningButtons">
            <p>Es wird gerade ein Test ausgeführt. Bitte wählen Sie durch Klicken auf eine der beiden Schaltflächen
              links, ob der Test fortgesetzt oder beendet werden soll!</p>
        </div>
        <app-errormsg></app-errormsg>

      </mat-card-content>
      <mat-card-actions>
        <button mat-raised-button color="foreground" *ngIf="!showLoginForm" (click)="changeLogin()">Test-Anmeldung ändern</button>
        <button mat-raised-button color="foreground" *ngIf="validCodes.length > 1" (click)="changeCode()">Personen-Code ändern</button>
        <p *ngIf="!showLoginForm || validCodes.length > 1">&nbsp;</p>
        <button mat-raised-button color="foreground" [routerLink]="['/about']">Impressum/Datenschutz</button>
      </mat-card-actions>
    </mat-card>
  </div>
</div>
