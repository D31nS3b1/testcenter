<div class="page-header">
  <p>IQB-Testcenter Gruppen√ºberwachung</p>
  <span class="fill-remaining-space"></span>
  <p>
    <mat-chip-list >
      <mat-chip class="{{(serviceConnected$ | async) ? 'live on' : 'live off'}}">
        {{(serviceConnected$ | async) ? 'live' : 'offline'}}
      </mat-chip>
    </mat-chip-list>
  </p>
</div>

<div class="page-body">
  <div class="adminbackground">

    <table mat-table [dataSource]="dataSource$">

      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let element" matTooltip="{{element.personId}}"><i class="material-icons">face</i></td>
      </ng-container>

      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Name</th>
        <td mat-cell *matCellDef="let element" matTooltip="{{element.personId}}">{{element.personLabel}}</td>
      </ng-container>

      <ng-container matColumnDef="personStatus">
        <th mat-header-cell *matHeaderCellDef>Status</th>
        <td mat-cell *matCellDef="let element">{{element.personStatus}}</td>
      </ng-container>

      <ng-container matColumnDef="test">
        <th mat-header-cell *matHeaderCellDef>Test</th>
        <td mat-cell *matCellDef="let element" matTooltip="{{element.testId}}">{{element.testLabel}}</td>
      </ng-container>

      <ng-container matColumnDef="testStatus">
        <th mat-header-cell *matHeaderCellDef>Test-Status</th>
        <td mat-cell *matCellDef="let element">
          <table>
            <tr *ngFor="let item of element.testState | keyvalue">
              <td>{{item.key}}</td><td>{{item.value}}</td>
            </tr>
          </table>
        </td>
      </ng-container>

      <ng-container matColumnDef="unit">
        <th mat-header-cell *matHeaderCellDef>Unit</th>
        <td mat-cell *matCellDef="let element">{{element.unitName}}</td>
      </ng-container>

      <ng-container matColumnDef="unitStatus">
        <th mat-header-cell *matHeaderCellDef>Unit-Status</th>
        <td mat-cell *matCellDef="let element">
          <table>
            <tr *ngFor="let item of element.unitState | keyvalue">
              <td>{{item.key}}</td><td>{{item.value}}</td>
            </tr>
          </table>
        </td>
      </ng-container>

      <ng-container matColumnDef="booklet">
        <th mat-header-cell *matHeaderCellDef>Debug</th>
        <td mat-cell *matCellDef="let element">
          <pre>getBookletInfo(element).getValue() | json}}</pre>
        </td>
      </ng-container>


      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>

    <p>Connected Admins: {{clientCount$ | async}}</p>

    <pre>{{dataSource$ | async | json}}</pre>

</div>
</div>
