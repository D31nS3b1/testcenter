<tc-detect-focus></tc-detect-focus>

<div style="color:orange; position: absolute; background:black; z-index:10000">
    <div><span class="color:white">STATUS:</span> {{tcs.testStatus$ | async}}</div>
    <div><span class="color:white">TIMER:</span> {{timerValue?.timeLeftString}} {{timerValue?.testletId}} {{timerValue?.type}}</div>
    <div><span class="color:white">MODE:</span> {{tcs.testMode.modeId}}</div>
    <div><span class="color:white">FOCUS:</span> {{focusService.focus$ | async}}</div>
</div>

<div id="header" fxLayout="row" fxLayoutAlign="end center">
    <p class="timer" *ngIf="tcs.testMode.showTimeLeft">{{ timerValue?.timeLeftString }}</p>
    <button mat-fab [disabled]="!tcs.unitPrevEnabled" *ngIf="(tcs.bookletConfig.unit_navibuttons !== 'OFF') && ((tcs.testStatus$ | async) === tcs.testStatusEnum.RUNNING)" color="accent"
            (click)="tcs.setUnitNavigationRequest(unitNavigationTarget.PREVIOUS)" matTooltip="ZurÃ¼ck" fxFlex="none">
      <i class="material-icons">chevron_left</i>
    </button>
    <div *ngIf="(tcs.bookletConfig.unit_navibuttons === 'FULL') && ((tcs.testStatus$ | async) === tcs.testStatusEnum.RUNNING)" fxLayout="row wrap" fxLayoutAlign="start center">
      <div *ngFor="let u of tcs.unitListForNaviButtons">
        <div fxLayout="column" fxLayoutAlign="start center">
            <button (click)="tcs.setUnitNavigationRequest(u.sequenceId.toString())" class="unit-button" [disabled]="u.disabled">{{ u.shortLabel }}</button>
            <span class="current-unit-dot" *ngIf="u.isCurrent"></span>
            <span class="notcurrent-unit-dot" *ngIf="!u.isCurrent"></span>
        </div>
      </div>
    </div>
    <button mat-fab [disabled]="!tcs.unitNextEnabled" *ngIf="(tcs.bookletConfig.unit_navibuttons !== 'OFF')  && ((tcs.testStatus$ | async) === tcs.testStatusEnum.RUNNING)" color="accent"
            (click)="tcs.setUnitNavigationRequest(unitNavigationTarget.NEXT)" matTooltip="Weiter" fxFlex="none">
      <i class="material-icons">chevron_right</i>
    </button>
    <div class="plus-buttons" fxFlex="none" fxLayout="row">
      <button mat-button (click)="showReviewDialog()" *ngIf="tcs.testMode.canReview" matTooltip="Kommentar senden" fxFlex="none">
        <mat-icon>rate_review</mat-icon>
      </button>
      <button mat-button (click)="tcs.setUnitNavigationRequest(unitNavigationTarget.MENU)"
              *ngIf="(tcs.bookletConfig.unit_menu !== 'OFF') || tcs.testMode.showUnitMenu"
              matTooltip="Zur Aufgabenliste" fxFlex="none">
        <mat-icon>menu</mat-icon>
      </button>
    </div>
</div>

<mat-card *ngIf="(tcs.testStatus$ | async) === tcs.testStatusEnum.WAITING_LOAD_COMPLETE" class="progress-bar">
  <mat-card-content fxLayout="column">
    <h2>Lade Aufgaben... bitte warten</h2>
    <mat-progress-bar
        color="primary"
        mode="determinate"
        [value]="loadProgressValue">
    </mat-progress-bar>
  </mat-card-content>
</mat-card>

<div class="tc-body" fxLayout="row" fxLayoutAlign="start stretch">
    <router-outlet></router-outlet>
</div>
